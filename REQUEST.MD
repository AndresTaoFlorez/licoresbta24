## Prompt Mejorado para Claude Code

```
# AN√ÅLISIS Y OPTIMIZACI√ìN DE PERFORMANCE - Lighthouse 35 ‚Üí 90+

## CONTEXTO DEL PROYECTO
- **Sitio:** licoresbta24.com (eCommerce de licores en Bogot√°)
- **Stack:** React + Vite + SCSS + Redux
- **Estado actual:** Visualmente pulido y funcional
- **Lighthouse scores:**
  - Performance: 35 ‚ùå
  - Accessibility: 84 ‚ö†Ô∏è
  - Best Practices: 100 ‚úÖ
  - SEO: 92 ‚úÖ

## CARACTER√çSTICAS T√âCNICAS CONOCIDAS
- Animaciones CSS complejas (backdrop-filter, blur, gradients)
- Redux para manejo de estado
- React Router para navegaci√≥n
- Componentes con efectos glassmorphism
- Im√°genes de productos (posiblemente sin optimizar)
- Efectos de parallax/background animados
- Fuentes custom (probablemente Google Fonts)

## OBJETIVO
Elevar Performance a **m√≠nimo 90** sin sacrificar la est√©tica visual premium del sitio.

---

## TAREAS ESPEC√çFICAS

### 1Ô∏è‚É£ AN√ÅLISIS PROFUNDO DEL BUILD
**Acci√≥n:** Analiza el bundle de producci√≥n actual.

```bash
# Ejecuta estos comandos y analiza resultados:
npm run build
ls -lh dist/assets/
```

**Detecta:**
- ‚úÖ Tama√±o total del JS bundle (objetivo: <200KB gzipped)
- ‚úÖ Dependencias pesadas (React Icons, animaciones, Redux)
- ‚úÖ C√≥digo no usado (tree-shaking efectivo)
- ‚úÖ Chunks duplicados

**Prop√≥n:**
- Code-splitting por rutas con React.lazy()
- Lazy loading de componentes pesados (ModernProductCard, Slider)
- An√°lisis con `rollup-plugin-visualizer`

---

### 2Ô∏è‚É£ OPTIMIZACI√ìN DE IM√ÅGENES Y ASSETS

**Detecta:**
- Im√°genes de productos sin compresi√≥n
- Formatos obsoletos (PNG/JPG en lugar de WebP/AVIF)
- Im√°genes cargadas antes del viewport
- SVGs sin optimizar
- Logos o iconos que podr√≠an ser inline SVG

**Prop√≥n:**
```jsx
// Ejemplo de optimizaci√≥n esperada:
<img 
  src="/products/whisky.webp"
  srcSet="/products/whisky-mobile.webp 480w, /products/whisky-desktop.webp 1200w"
  sizes="(max-width: 768px) 480px, 1200px"
  loading="lazy"
  decoding="async"
  alt="..."
/>
```

**Herramientas a configurar:**
- `vite-plugin-imagemin` para compresi√≥n autom√°tica
- Conversi√≥n a WebP/AVIF en build time
- Lazy loading nativo en todas las im√°genes no-hero

---

### 3Ô∏è‚É£ REDUCCI√ìN DE COSTO DE RENDERIZADO

**Identifica componentes con:**
- `backdrop-filter: blur()` (muy costoso en m√≥vil)
- Animaciones con `transform` no optimizadas
- Sombras complejas (`box-shadow` con m√∫ltiples capas)
- Gradientes animados
- Re-renders innecesarios

**Prop√≥n alternativas:**
```scss
// MAL (costoso)
.card {
  backdrop-filter: blur(20px);
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

// BIEN (optimizado)
.card {
  background: rgba(0,0,0,0.8); // blur est√°tico en imagen de fondo
  box-shadow: 0 4px 12px rgba(0,0,0,0.3); // sombra m√°s simple
  will-change: transform; // hint al navegador
}
```

**Optimiza animaciones:**
- Usa `transform` y `opacity` √∫nicamente
- Evita `width`, `height`, `top`, `left` en animaciones
- A√±ade `will-change` selectivamente
- React.memo() en componentes que no necesitan re-render

---

### 4Ô∏è‚É£ OPTIMIZACI√ìN DE FUENTES

**Detecta:**
- Fuentes externas sin preload
- M√∫ltiples pesos de fuente cargados innecesariamente
- `font-display` no configurado

**Prop√≥n:**
```html
<!-- index.html optimizado -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link 
  rel="preload" 
  as="style"
  href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
>
<link 
  rel="stylesheet" 
  href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap"
  media="print" 
  onload="this.media='all'"
>
```

**Configuraci√≥n SCSS:**
```scss
// A√±adir font-display en @font-face custom
@font-face {
  font-family: 'CustomFont';
  src: url('/fonts/custom.woff2') format('woff2');
  font-display: swap; // cr√≠tico para performance
}
```

---

### 5Ô∏è‚É£ CONFIGURACI√ìN DE VITE OPTIMIZADA

**Prop√≥n `vite.config.js` mejorado:**
```javascript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react-swc';
import { visualizer } from 'rollup-plugin-visualizer';
import viteCompression from 'vite-plugin-compression';
import viteImagemin from 'vite-plugin-imagemin';

export default defineConfig({
  plugins: [
    react(),
    
    // Compresi√≥n Brotli
    viteCompression({
      algorithm: 'brotliCompress',
      ext: '.br',
    }),
    
    // An√°lisis de bundle
    visualizer({
      open: true,
      gzipSize: true,
      brotliSize: true,
    }),
    
    // Optimizaci√≥n de im√°genes
    viteImagemin({
      gifsicle: { optimizationLevel: 7 },
      optipng: { optimizationLevel: 7 },
      mozjpeg: { quality: 80 },
      svgo: {
        plugins: [
          { name: 'removeViewBox', active: false },
          { name: 'removeEmptyAttrs', active: false },
        ],
      },
    }),
  ],
  
  build: {
    // Optimizaciones de producci√≥n
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true,
      },
    },
    
    // Code splitting inteligente
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom', 'react-router-dom'],
          'redux-vendor': ['@reduxjs/toolkit', 'react-redux'],
          'ui-vendor': ['lucide-react'],
        },
      },
    },
    
    // Chunk size warnings
    chunkSizeWarningLimit: 500,
    
    // CSS code splitting
    cssCodeSplit: true,
  },
  
  // Optimizaci√≥n de dependencias
  optimizeDeps: {
    include: ['react', 'react-dom', 'react-router-dom'],
  },
});
```

---

### 6Ô∏è‚É£ CODE SPLITTING Y LAZY LOADING

**Identifica rutas y componentes a hacer lazy:**
```javascript
// App.jsx - Lazy loading de p√°ginas
import { lazy, Suspense } from 'react';

const SwipeToEnter = lazy(() => import('./presentation/pages/SwipeToEnter/SwipeToEnter'));
const Home = lazy(() => import('./presentation/pages/Home/Home'));
const CategoryPage = lazy(() => import('./presentation/pages/Category/CategoryPage'));

// Componentes pesados tambi√©n
const ModernProductCard = lazy(() => import('./presentation/components/shared/ModernProductCard'));
```

---

### 7Ô∏è‚É£ OPTIMIZACI√ìN DE REDUX

**Detecta:**
- Selectors sin memoizaci√≥n
- Estado innecesario en Redux
- Re-renders por cambios irrelevantes

**Prop√≥n:**
```javascript
// Usar createSelector de reselect
import { createSelector } from '@reduxjs/toolkit';

const selectProducts = (state) => state.products.items;
const selectCategory = (state) => state.filters.category;

export const selectFilteredProducts = createSelector(
  [selectProducts, selectCategory],
  (products, category) => 
    products.filter(p => p.category === category)
);
```

---

## DIAGN√ìSTICO FINAL ESPERADO

### üîç AN√ÅLISIS RESUMIDO
```
Bundle actual:
  - JS total: XXX KB (gzipped)
  - CSS total: XXX KB
  - Im√°genes: XXX MB sin comprimir
  - Dependencias pesadas detectadas: [lista]

Principales problemas:
  1. [Problema espec√≠fico con m√©trica]
  2. [Problema espec√≠fico con m√©trica]
  3. [Problema espec√≠fico con m√©trica]
```

### üß† CUELLOS DE BOTELLA DETECTADOS
```
Alto impacto:
  - ‚ùå Im√°genes sin lazy loading (FCP +2.5s)
  - ‚ùå Bundle de 500KB sin code-splitting (TTI +3s)
  - ‚ùå backdrop-filter en 15 componentes (FPS <30)

Medio impacto:
  - ‚ö†Ô∏è Fuentes bloqueando renderizado (+0.8s)
  - ‚ö†Ô∏è Redux causando re-renders innecesarios

Bajo impacto:
  - üí° SVGs sin optimizar (+50KB)
```

### ‚öôÔ∏è PLAN DE ACCI√ìN PRIORIZADO

**üî¥ PRIORIDAD ALTA (Hacer primero - Mayor impacto)**
1. Code-splitting de rutas
2. Lazy loading de im√°genes
3. Optimizaci√≥n de backdrop-filter
4. Configuraci√≥n de Vite mejorada

**üü° PRIORIDAD MEDIA**
1. Optimizaci√≥n de fuentes
2. Memoizaci√≥n de Redux selectors
3. Compresi√≥n de assets

**üü¢ PRIORIDAD BAJA**
1. Optimizaci√≥n de SVGs
2. Preload de recursos cr√≠ticos

### üöÄ CONFIGURACI√ìN DE BUILD FINAL
[Vite config completo optimizado]

---

## FORMATO DE RESPUESTA ESPERADO

Para cada optimizaci√≥n, proporciona:
- ‚úÖ **Qu√© hacer** (acci√≥n espec√≠fica)
- üìä **Impacto esperado** (ej: "FCP -1.2s, LCP -2.1s")
- üîß **C√≥digo exacto** (sin pseudoc√≥digo)
- ‚è±Ô∏è **Tiempo de implementaci√≥n** (5 min / 30 min / 2 horas)
- üéØ **Prioridad** (Alta/Media/Baja)

## RESTRICCIONES
- ‚ùå NO sacrificar la est√©tica visual premium
- ‚ùå NO eliminar animaciones clave del UX
- ‚úÖ Mantener compatibilidad con navegadores modernos (√∫ltimos 2 a√±os)
- ‚úÖ Enfoque mobile-first (80% del tr√°fico es m√≥vil)

## ENTREGABLES
1. Lista priorizada de optimizaciones con c√≥digo
2. `vite.config.js` optimizado completo
3. Snippets de c√≥digo para componentes cr√≠ticos
4. Checklist de verificaci√≥n post-implementaci√≥n
5. Estimaci√≥n de mejora de score (35 ‚Üí XX)

S√© espec√≠fico, t√©cnico y directo. Evita teor√≠a gen√©rica.
```

---

**Este prompt est√° dise√±ado para que Claude Code analice tu proyecto completo y d√© soluciones concretas e implementables.** üöÄ